#todo: fix this and make some unit tests